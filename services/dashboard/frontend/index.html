<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>IMIQ Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/favicon.png" type="image/png">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.fullscreen@1.6.0/Control.FullScreen.css" />
    <link rel="stylesheet" href="https://unpkg.com/cesium@1.120.0/Build/Cesium/Widgets/widgets.css"/>
    <link rel="stylesheet" href="/api/dashbot/static/dashbot-widget.css"/>
    <script src="/api/dashbot/static/dashbot-widget.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1"></script>
    <style>
      html, body, #map {
        height: 100%;
        margin: 0;
        padding: 0;
      }
  
      select {
        font-size: 14px;
      }
  
      .dropdown {
        position: absolute;
        top: 10px;
        left: 56px;
        z-index: 1500;
        background: white;
        padding: 8px;
        border-radius: 4px;
        font-family: sans-serif;
        box-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
      }

      .vehicle-icon {
        background: transparent !important;
        border: none !important;
        text-align: center;
        font-size: 24px;
        line-height: 1;
      }
      #modeSwitcher {
        position: absolute;
        top: 10px;
        left: 400px;                 /* ~next to zoom buttons */
        z-index: 1300;              /* above map & Cesium overlay */
        display: flex;
        gap: 8px;
      }
      #modeSwitcher button {
        padding: 8px 12px;
        border: none;
        border-radius: 999px;
        background: linear-gradient(90deg,#111827,#374151);
        color: #fff;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        font-size: 14px;
        box-shadow: 0 6px 16px rgba(0,0,0,.25);
        cursor: pointer;
        transition: transform .08s ease, box-shadow .15s ease;
      }
      #modeSwitcher button:hover { transform: translateY(-1px); box-shadow: 0 10px 22px rgba(0,0,0,.28); }
      .mode-active { outline: 2px solid #60a5fa; }
    
      /* Overlay stays below the controls */
      #cesiumOverlay { position: absolute; inset: 0; display: none; z-index: 1200; background: #0b0f19; }
      #cesiumContainer { position: absolute; inset: 0; }
    
      dialog {
        border: none;
        border-radius: 8px;
        padding: 1.5rem;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      }
      dialog::backdrop {
        background: rgba(0,0,0,0.5);
      }
      .close-btn {
        position: absolute;
        top: 8px;
        right: 10px;
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
        line-height: 1;
      }
      .close-btn:hover {
        color: red;
      }
    </style>
  </head>
  
  <body>

  <dialog id="chartDialog">
    <p id="chartText"></p>
    <canvas id="chartCanvas"></canvas>
    <button class="close-btn" onclick="closeGraph()">‚úï</button>
  </dialog>

  <!-- Map container -->
  <div id="map">
  
    <!-- Dropdown to toggle sensor display -->
    <div class="dropdown">
        <div class="menu-wrapper">
          <label class="main-label">üõ∞Ô∏è Smart View</label>
          <select id="sensorType">
            <option value="">-- Select Option --</option>
          </select>
        </div>

      </div>
      <div id="modeSwitcher" class="leaflet-control">
        <button id="btn2D" title="Switch to 2D">üó∫Ô∏è 2D</button>
        <button id="btn3D" title="Switch to 3D">üß≠ 3D</button>
      </div>

      <!-- Cesium overlay (no close button now) -->
      <div id="cesiumOverlay">
        <div id="cesiumContainer"></div>
      </div>
    </div>

     <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <!--  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script> -->
     <script src="https://unpkg.com/cesium@1.120.0/Build/Cesium/Cesium.js"></script> 
     <script src="https://unpkg.com/leaflet.fullscreen@1.6.0/Control.FullScreen.js"></script>
     <script src="script.js"></script>
  </body>
  
</html>
